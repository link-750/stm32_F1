  #include"stm32f10x.h"
  #include<stdio.h>
  
  void USART_gpio_init();//led灯的gpio函数的声明
  void USART_Configuration();
  void RCC_Configuration(); 
  void delay();
  float ji_dat[]={0};
  float lv_dat[]={0,0.000000,0.000009,0.000204,0.001371,0.005142,0.013369,0.027042,0.046094,0.073351,0.121484,0.208049,0.334638,0.475414,0.590253,0.646575,0.632206,0.557107,0.447064,0.331262,0.230741,0.155021,0.105014,0.077069,0.066349,0.069084,0.081985,0.099943,0.116221,0.125123,0.124011,0.113557,0.096782,0.077511,0.058889,0.042868,0.030530,0.022351,0.018296,0.017907,0.020393,0.024586,0.028942,0.031998,0.032920,0.031671,0.028842,0.025363,0.022152,0.019756,0.018220,0.017332,0.016908,0.016876,0.017170,0.017643,0.018092,0.018310,0.018132,0.017551,0.016738,0.015917,0.015243,0.014799,0.014603,0.014574,0.014551,0.014389,0.014065,0.013679,0.013360,0.013167,0.013069,0.012999,0.012906,0.012769,0.012607,0.012457,0.012342,0.012235,0.012064,0.011759,0.011306,0.010782,0.010334,0.010083,0.010060,0.010190,0.010347,0.010437,0.010436,0.010367,0.010251,0.010091,0.009893,0.009678,0.009472,0.009311,0.009241,0.009281,0.009407,0.009577,0.009753,0.009879,0.009893,0.009748,0.009465,0.009158,0.008962,0.008926,0.008992,0.009063,0.009059,0.008935,0.008694,0.008369,0.008005,0.007656,0.007394,0.007265,0.007243,0.007253,0.007240,0.007194,0.007130,0.007080,0.007083,0.007139,0.007190,0.007167,0.007056,0.006887,0.006711,0.006584,0.006528,0.006503,0.006458,0.006366,0.006234,0.006105,0.006047,0.006108,0.006275,0.006484,0.006643,0.006664,0.006517,0.006242,0.005925,0.005656,0.005505,0.005495,0.005596,0.005746,0.005885,0.005988,0.006059,0.006085,0.006035,0.005899,0.005703,0.005486,0.005288,0.005146,0.005088,0.005125,0.005228,0.005331,0.005376,0.005354,0.005290,0.005212,0.005150,0.005144,0.005213,0.005324,0.005406,0.005416,0.005369,0.005321,0.005304,0.005285,0.005225,0.005124,0.004991,0.004826,0.004648,0.004486,0.004344,0.004194,0.004020,0.003858,0.003780,0.003838,0.004029,0.004296,0.004552,0.004712,0.004730,0.004621,0.004440,0.004249,0.004108,0.004045,0.004037,0.004028,0.003985,0.003919,0.003886,0.003937,0.004074,0.004245,0.004380,0.004438,0.004420,0.004363,0.004304,0.004255,0.004217,0.004195,0.004209,0.004273,0.004390,0.004549,0.004726,0.004894,0.005020,0.005062,0.004987,0.004790,0.004500,0.004164,0.003826,0.003524,0.003312,0.003242,0.003325,0.003513,0.003717,0.003840,0.003813,0.003638,0.003391,0.003186,0.003123,0.003224,0.003417,0.003578,0.003607,0.003500,0.003347,0.003238,0.003218,0.003292,0.003451,0.003682,0.003967,0.004276,0.004567,0.004791,0.004899,0.004858,0.004672,0.004374,0.004001,0.003598,0.003216,0.002892,0.002652,0.002526,0.002544,0.002734,0.003096,0.003580,0.004083,0.004486,0.004703,0.004736,0.004668,0.004566,0.004433,0.004246,0.004002,0.003721,0.003422,0.003130,0.002891,0.002731,0.002642,0.002607,0.002613,0.002654,0.002736,0.002874,0.003057,0.003256,0.003457,0.003646,0.003803,0.003913,0.003982,0.004005,0.003964,0.003840,0.003646,0.003434,0.003267,0.003197,0.003252,0.003437,0.003727,0.004064,0.004377,0.004600,0.004673,0.004566,0.004289,0.003898,0.003471,0.003079,0.002761,0.002530,0.002385,0.002331,0.002376,0.002531,0.002772,0.003025,0.003201,0.003260,0.003230,0.003186,0.003202,0.003304,0.003456,0.003604,0.003720,0.003790,0.003780,0.003670,0.003483,0.003281,0.003130,0.003066,0.003077,0.003121,0.003161,0.003180,0.003181,0.003185,0.003212,0.003260,0.003314,0.003365,0.003413,0.003451,0.003449,0.003377,0.003242,0.003072,0.002874,0.002628,0.002328,0.002014,0.001770,0.001666,0.001715,0.001865,0.002045,0.002203,0.002322,0.002404,0.002453,0.002469,0.002457,0.002450,0.002490,0.002592,0.002729,0.002862,0.002959,0.003011,0.003028,0.003019,0.002991,0.002952,0.002907,0.002859,0.002813,0.002778,0.002747,0.002705,0.002630,0.002530,0.002471,0.002528,0.002711,0.002968,0.003248,0.003512,0.003717,0.003818,0.003809,0.003713,0.003559,0.003369,0.003175,0.003028,0.002966,0.002985,0.003037,0.003073,0.003067,0.003029,0.002993,0.002986,0.003026,0.003104,0.003193,0.003242,0.003199,0.003052,0.002849,0.002662,0.002552,0.002548,0.002641,0.002792,0.002959,0.003096,0.003172,0.003187,0.003186,0.003226,0.003329,0.003452,0.003534,0.003552,0.003508,0.003401,0.003230,0.003010,0.002762,0.002503,0.002255,0.002034,0.001865,0.001782,0.001808,0.001933,0.002115,0.002308,0.002480,0.002611,0.002693,0.002716,0.002680,0.002619,0.002582,0.002592,0.002634,0.002695,0.002781,0.002878,0.002961,0.003010,0.003025,0.003003,0.002935,0.002818,0.002679,0.002561,0.002503,0.002517,0.002565,0.002598,0.002588,0.002532,0.002441,0.002338,0.002235,0.002130,0.002036,0.001981,0.001980,0.002024,0.002080,0.002115,0.002110,0.002072,0.002025,0.001991,0.001982,0.002003,0.002051,0.002109,0.002143,0.002136,0.002102,0.002077,0.002105,0.002212,0.002365,0.002484,0.002518,0.002501,0.002511,0.002588,0.002707,0.002818,0.002882,0.002888,0.002860,0.002826,0.002809,0.002806,0.002811,0.002831,0.002885,0.002982,0.003108,0.003211,0.003234,0.003155,0.002992,0.002788,0.002591,0.002436,0.002324,0.002226,0.002120,0.002022,0.001958,0.001934,0.001939,0.001971,0.002030,0.002111,0.002203,0.002284,0.002318,0.002273,0.002158,0.002028,0.001961,0.002009,0.002165,0.002374,0.002574,0.002716,0.002778,0.002782,0.002776,0.002792,0.002833,0.002880,0.002900,0.002856,0.002735,0.002557,0.002380,0.002280,0.002300,0.002408,0.002540,0.002659,0.002762,0.002846,0.002893,0.002881,0.002798,0.002631,0.002394,0.002134,0.001903,0.001722,0.001600,0.001562,0.001631,0.001788,0.001981,0.002155,0.002276,0.002324,0.002292,0.002211,0.002133,0.002095,0.002112,0.002182,0.002271,0.002333,0.002359,0.002382,0.002440,0.002526,0.002599,0.002601,0.002503,0.002330,0.002157,0.002057,0.002043,0.002073,0.002094,0.002071,0.001998,0.001891,0.001790,0.001732,0.001725,0.001760,0.001851,0.002016,0.002241,0.002488,0.002719,0.002909,0.003033,0.003066,0.002992,0.002812,0.002544,0.002229,0.001930,0.001712,0.001617,0.001637,0.001727,0.001835,0.001927,0.001990,0.002025,0.002047,0.002074,0.002115,0.002150,0.002139,0.002073,0.001993,0.001950,0.001954,0.001979,0.001991,0.001973,0.001931,0.001874,0.001812,0.001774,0.001796,0.001903,0.002099,0.002355,0.002615,0.002847,0.003049,0.003202,0.003266,0.003212,0.003040,0.002764,0.002423,0.002079,0.001812,0.001701,0.001779,0.002011,0.002302,0.002552,0.002685,0.002674,0.002535,0.002309,0.002045,0.001789,0.001589,0.001488,0.001496,0.001595,0.001761,0.001957,0.002127,0.002231,0.002267,0.002274,0.002308,0.002408,0.002576,0.002768,0.002906,0.002929,0.002819,0.002594,0.002301,0.002006,0.001781,0.001680,0.001722,0.001886,0.002115,0.002338,0.002502,0.002585,0.002587,0.002504,0.002331,0.002072,0.001780,0.001539,0.001434,0.001523,0.001790,0.002129,0.002397,0.002490,0.002403,0.002208,0.002015,0.001931,0.002023,0.002272,0.002580,0.002836,0.002962,0.002937,0.002797,0.002595,0.002374,0.002164,0.001997,0.001911,0.001924,0.002017,0.002128,0.002194,0.002188,0.002131,0.002065,0.002038,0.002085,0.002191,0.002300,0.002383,0.002459,0.002545,0.002617,0.002644,0.002606,0.002501,0.002344,0.002172,0.002025,0.001935,0.001920,0.001982,0.002096,0.002214,0.002276,0.002250,0.002167,0.002093,0.002071,0.002085,0.002088,0.002036,0.001914,0.001752,0.001595,0.001480,0.001430,0.001464,0.001587,0.001793,0.002050,0.002308,0.002528,0.002689,0.002778,0.002796,0.002758,0.002690,0.002608,0.002523,0.002450,0.002391,0.002322,0.002228,0.002130,0.002088,0.002141,0.002283,0.002453,0.002567,0.002565,0.002440,0.002228,0.001966,0.001686,0.001416,0.001191,0.001041,0.000990,0.001050,0.001206,0.001425,0.001663,0.001869,0.002001,0.002039,0.001996,0.001919,0.001850,0.001798,0.001757,0.001738,0.001780,0.001914,0.002119,0.002322,0.002446,0.002459,0.002379,0.002252,0.002122,0.002015,0.001939,0.001898,0.001895,0.001935,0.002008,0.002099,0.002190,0.002260,0.002286,0.002256,0.002168,0.002029,0.001860,0.001694,0.001560,0.001470,0.001425,0.001432,0.001496,0.001604,0.001720,0.001806,0.001841,0.001828,0.001803,0.001812,0.001873,0.001957,0.002026,0.002060,0.002047,0.001983,0.001887,0.001803,0.001770,0.001794,0.001865,0.001964,0.002074,0.002173,0.002238,0.002270,0.002285,0.002290,0.002268,0.002208,0.002114,0.002002,0.001895,0.001825,0.001803,0.001820,0.001865,0.001947,0.002083,0.002267,0.002475,0.002681,0.002854,0.002965,0.002983,0.002890,0.002684,0.002395,0.002076,0.001789,0.001594,0.001536,0.001630,0.001857,0.002153,0.002413,0.002545,0.002512,0.002333,0.002067,0.001790,0.001577,0.001474,0.001489,0.001596,0.001747,0.001888,0.001975,0.002001,0.002010,0.002070,0.002205,0.002369,0.002505,0.002581,0.002584,0.002513,0.002384,0.002220,0.002053,0.001926,0.001892,0.001987,0.002212,0.002522,0.002832,0.003059,0.003150,0.003108,0.002981,0.002817,0.002645,0.002484,0.002341,0.002226,0.002158,0.002153,0.002203,0.002281,0.002341,0.002337,0.002244,0.002071,0.001861,0.001680,0.001582,0.001593,0.001713,0.001929,0.002219,0.002536,0.002802,0.002933,0.002880,0.002649,0.002293,0.001890,0.001526,0.001263,0.001129,0.001135,0.001281,0.001524,0.001784,0.001976,0.002043,0.001983,0.001848,0.001709,0.001612,0.001583,0.001634,0.001751,0.001897,0.002035,0.002147,0.002233,0.002295,0.002348,0.002418,0.002509,0.002600,0.002666,0.002686,0.002641,0.002532,0.002373,0.002175,0.001962,0.001780,0.001674,0.001648,0.001676,0.001740,0.001846,0.001999,0.002181,0.002352,0.002473,0.002532,0.002530,0.002475,0.002379,0.002254,0.002108,0.001956,0.001820,0.001719,0.001654,0.001619,0.001599,0.001584,0.001585,0.001625,0.001718,0.001851,0.001992,0.002105,0.002156,0.002127,0.002041,0.001955,0.001919,0.001938};
  void main()
{  long i;
   int t;
   float temp;
  RCC_Configuration();
  USART_gpio_init();
  USART_Configuration();  

   for(i=1;i<1025;i++)
   {
     if((lv_dat[i]>lv_dat[i-1])&&(lv_dat[i]>lv_dat[i+1]))
       ji_dat[i]=lv_dat[i];
     else
       ji_dat[i]=0;
   }
   for(i=0;i<1025;i++)
   {
     printf("%f\t",ji_dat[i]);
   }
                   
}
////////////////////////////////////////////////////////重点
  int fputc(int ch,FILE *f)
{
//ch送给USART1
USART_SendData(USART1, ch);
//等待发送完毕
while(USART_GetFlagStatus(USART1, USART_FLAG_TC)==RESET) { }
//返回ch
return(ch);
}
/////////////////////////////////////////////////////////////////
    void RCC_Configuration()
    {
        SystemInit();
        RCC_APB2PeriphClockCmd( RCC_APB2Periph_AFIO,ENABLE);//外部复用功能时钟
        RCC_APB2PeriphClockCmd( RCC_APB2Periph_GPIOA,ENABLE);/*使能a口gpio的rcc时钟*/
        RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1,ENABLE);
        RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC1,ENABLE);
        RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1,ENABLE);
        RCC_ADCCLKConfig(RCC_PCLK2_Div6);//12M
    }
    void USART_gpio_init()
{      
       
       GPIO_InitTypeDef GPIO_InitStructure;//定义结构体
       //pa9为ua1的tx端  
       GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;//定义引脚速度
       GPIO_InitStructure.GPIO_Pin=GPIO_Pin_9;//定义引脚
       GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP;//定义输出模式
       GPIO_Init(GPIOA,&GPIO_InitStructure);//初始化
       //pa10为ua1的rx端
       GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;//定义引脚速度
       GPIO_InitStructure.GPIO_Pin=GPIO_Pin_10;//定义引脚
       GPIO_InitStructure.GPIO_Mode=GPIO_Mode_IN_FLOATING;//定义输出模式
       GPIO_Init(GPIOA,&GPIO_InitStructure);//初始化
       //ad口
       GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;//定义引脚速度
       GPIO_InitStructure.GPIO_Pin=GPIO_Pin_1;//定义引脚
       GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AIN;//定义输出模式-模拟输入
       GPIO_Init(GPIOA,&GPIO_InitStructure);//初始化
            
}
   
   void USART_Configuration()
   {
   
    USART_InitTypeDef USART_InitStructure;
    USART_InitStructure.USART_BaudRate = 9600;
    USART_InitStructure.USART_WordLength = USART_WordLength_8b;
    USART_InitStructure.USART_StopBits = USART_StopBits_1;
    USART_InitStructure.USART_Parity = USART_Parity_No;
    USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
    USART_InitStructure.USART_Mode = USART_Mode_Tx;
    USART_Init(USART1,&USART_InitStructure);  
    USART_ITConfig(USART1,USART_IT_TXE,ENABLE);//使能发送中断
    USART_ClearFlag(USART1,USART_FLAG_TC);//清除待处理标志位
    USART_Cmd(USART1,ENABLE);//使能外设
    
   }

    
   
     void delay()
     {
         int i=0;
         for(i=0;i<=12000000;i++);
     }